Tags: #
***
###
1) создаем файлик

![[Pasted image 20220702113651.png]]

2) сама бмблиотечная функция

![[Pasted image 20220702113752.png]]

3) собираем динамическую библиотеку

![[Pasted image 20220702113937.png]]
- объявлено два символа - D - экспортируемая перменная, что будет видна во всех модулях. она распологается в секции DATA бинарного модуля, а в GOT будет записана на нее ссылка;

![[Pasted image 20220702115924.png]]
- из регистра edi передается параметр функции на 14 байт;
- чтобы понять, где лежит наша глобальная переменная, мы текущие значение rip записываем в rax, это делается потому что по этим адресам должна будет расположена GOT, а в нулях должна быть расположена глобальная переменная;
- то что лежит в rax положить в edx, а то, что лежит в -14rbp положить в eax. далее произвести сложение edx и eax и сохранить в eax;

Вывод: GOT нет;

![[Pasted image 20220702122201.png]]

смещение к глобальной переменной расположено по адресу "0xе"

4) скомпилируем библиотеку и сравлим ее с модулем

![[Pasted image 20220702122740.png]]

![[Pasted image 20220702122807.png]]

появились got секции и адреса - в got лежит адрес 3fdo, то есть к глобальной перменной my_glob. сравним значения с диссасемблированием;

![[Pasted image 20220702123305.png]] 

видно, что нас куда-то отправили и там будет хранится ссылка на эту перменную;

![[Pasted image 20220702123616.png]]

5) дособираем программу

![[Pasted image 20220702123952.png]]

![[Pasted image 20220702124200.png]]

![[Pasted image 20220702124953.png]]

исполняемый модуль все видет, как статическую релокацию;

![[Pasted image 20220702125254.png]]

 ошибка, так как он не видет библиотеку в окружении
 
 ![[Pasted image 20220702125420.png]]
 
 6) анализ

![[Pasted image 20220702125542.png]]
![[Pasted image 20220702125606.png]]

got - для глобальных переменных
plt.got - для функций;

![[Pasted image 20220702130112.png]]

диссасемблируем

![[Pasted image 20220702130326.png]]

прыгаем в plt

![[Pasted image 20220702130602.png]]

прагаем в got

![[Pasted image 20220702130842.png]]

нас перенаправит в resolver;

####

***
#### Zero_Link
- 
***
### Links
Up:

Down:


