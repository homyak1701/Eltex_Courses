Tags: #
***
#### заголовок системных вызовов
- fcntl.h - open;
- unistd.h - close, read;

#### системные вызоры ввода/вывода
- предназначены, чтобы работать в режиме буферизации ядра

	![[Pasted image 20220705212043.png]]

***

### 1) open()
- открытие файла для его изменения, а точнее создание файлового дескриптора;
	- прототипы:
		![[Pasted image 20220705124023.png]]
	- адаптированный прототип:
		![[Pasted image 20220705124050.png]]
	- аргументы:
		1) имя файла в файловой системе в обычной форме, ту есть путь до файла;
		2) режим открытия файла (использование побитового ИЛИ):
		
			![[Pasted image 20220705124352.png]]
			
		3) используется если создается новый файл и ему нужно передать права доступа, с которыми он появится в файловой системе;
			
			![[Pasted image 20220705124759.png]]
			
	- если файл был открыт успешно, то будет возвращен его файловый дискриптор, в противном случае ( -1 );
	
	- если файл открыт каким-либо процессом, то его нельзя удалить;
#### 2) close()
- 
	- прототип:
		![[Pasted image 20220705130317.png]]
	 - аргументы:
	 	1) дискриптор файла;
	
#### 3) read()
- возвращается действиетльно (ssize_t) прочитанное количетсво байт;
	- прототип:
	
		![[Pasted image 20220705131234.png]]
	
	- аргументы:
	
		1) файловый дискриптор;
		2) указатель на область в памяти (буфер в области пользователя), куда будут помещатсья данные;
		3) количетсво байт, которые будут читаться из файла (лучше читать по блокам);
		
	- успешное прочтение возвращает количество прочитанных байт, в противном случае ( -1 );
	- тип **ssize_t** - указывает сколько мы символов смогли прочитать, записать. если мы выделили больше байт, чем прочитали, то вернется только то количество, что прочитали; 

#### 4) write()
- записывает count байтов из буфера buffer в файл с дескриптором fd, возвращая количество дейтсвительно записанных байтов или -1 в случае ошибки.

	- прототип:  ![[Pasted image 20220705220349.png]]
	- аргументы:
	1) 1) файловый дискриптор;
		2) указатель на область в памяти (буфер в области пользователя), откуда будут записыватся;
			- const стоит для того, чтобы стороку нельзя было модифицировать;
		3) количетсво байт, которые будут читаться из файла (лучше читать по блокам);

- каждый повторный вызов read() читает **следующие** данные, и каждый повторный write() записывает данные **в продолжение** предыдущих, а не затирает старые.
- **возвращает** количетсво байт, которые были записаны в буфер;

#### 5) off_t Iseek()
- изменения текущей позиции чтения-записи

	- прототип: ![[Pasted image 20220705221600.png]]

	- аргументы:
		1) файловый дискриптор;
		2) смещение, как положительное (вперед), так и отрицательное (назад).
		3) обычно передается в виде одной из трех констант: 
			- SEEK_SET - означает начало файла;
			- SEEK_CUR - текущая позиция;
			- SEEK_END - конец файла;

#### 6) readv()
- Системный вызов readv() работает также как read, но считывает несколько буферов.
	- прототип: ![[Pasted image 20220705223120.png]]
	
		![[Pasted image 20220705223048.png]]
		
	- для того, чтобы прочитать разорвано нужно создать,например,  три структуры в каждой нужно будет ссылкаться на буфер из пространтсва и какой размера этот буфер;

#### 7) writev()
- запись в одном процессе в буфера, которые могут находится нелинейно друг за другом;
	
	- прототип: ![[Pasted image 20220705223203.png]]
	
	![[Pasted image 20220705223048.png]]
		
	- для того, чтобы прочитать из разорванных кусков нужно создать три структуры в каждой нужно будет ссылкаться на буфер из пространтсва и какой размера этот буфер;

#### 8)stat()
- Данные системные вызовы возвращают информацию о файле в буфер, на который указывает _buf_.
	- прототип:  ![[Pasted image 20220705223845.png]]
	
	- аргументы:
		1) имя файла
		2) структура

#### 9) sync()
- приводит к записи в файловую систему всех изменений данных и метаданных файла, хранящихся в буфере.
	
	- прототипы: 
		- void sync(void);
		- int syncfs(int fd);

***
#### Zero_Link
- [[00 Команды]]
- [[00 Дескриптор]]
- [[00 Коретка]]
***
### Links
Up:
[[6.4.6.1. буферизация в файловой системе]]
[[6.4.6.3. файловый дескриптор]]

Down:


